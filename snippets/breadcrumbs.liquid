{% if settings.show_breadcrumbs %}
  {% unless template.name == 'index' or template.name == 'cart' %}
    <nav class="breadcrumb {{ classes }}" role="navigation" aria-label="breadcrumbs">
      <a href="{{ routes.root_url }}" title="{{ 'general.breadcrumbs.home_link_title' | t }}">
        {{- 'general.breadcrumbs.home' | t -}}
      </a>

      {% if template.name == 'product' %}
          {% if settings.show_breadcrumbs_collection_link %}
            <span class="breadcrumb__divider {{ routes }}" aria-hidden="true">{% render 'icon-caret' %}</span>
            <a href="{{ routes.collections_url }}">{{ 'general.search.collections' | t | replace: ':', '' }}</a>
          {% endif %}
      {% comment %} {% if collection %}

          <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
          {% if collection.handle %}
            {% capture url %}{{ routes.collections_url }}/{{ collection.handle }}{% endcapture %}
            {{ collection.title | link_to: url }}
          {% endif %}
        {% endif %} {% endcomment %}
        {%- assign product_collections = product.collections | reverse -%}

        {%- assign current_collection = product_collections.first %}

        {%- if current_collection -%}
          <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
          <a href="{{ current_collection.url }}">{{ current_collection.title }}</a>
        {%- endif -%}
        
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        <span aria-current="page" class="is-current">
          {%- if check_block_combo -%}
            Combo&nbsp;
          {%- endif -%}
          {{ product.title | split: '|' | first }}
          {%- if check_block_combo -%}
            {%- for bundle in handle_metafields.value -%}
              {{ bundle.title | prepend: '+ ' }}
            {%- endfor -%}
          {%- endif -%}
        </span>

      {% elsif template.name == 'collection' and collection.handle %}
        {% for link in linklists['main-menu-2'].links %}
          {% if link.child_active or link.active %}
           <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
            <a href="{{ link.url }}" class="link-class">
              {{ link.title | escape }}
            </a>
            {% for clink in link.links %}
              {% if clink.child_active or clink.active %}
                {% if clink.url != link.url %}
                  <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
                  <a href="{{ clink.url }}" class="clink-class">
                    {{ clink.title | escape }}
                  </a>
                  {% for gclink in clink.links %}
                    {% if gclink.child_active or gclink.active %}
                      <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
                      <a href="{{ gclink.url }}" class="gclink-class">
                        {{ gclink.title | escape }}
                      </a>
                    {% endif %}
                  {%- endfor -%}
                {% endif %}
              {%- endif -%}

            {%- endfor -%}
          {% endif %}
        {%- endfor -%}

      {% elsif template.name == 'blog' %}
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        {% if current_tags %}
          {{ blog.title | link_to: blog.url }}
          <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
          <span aria-current="page" class="is-current">{{ current_tags | join: ' + ' }}</span>
        {%- else -%}
          <span aria-current="page" class="is-current">{{ blog.title }}</span>
        {% endif %}

      {% elsif template.name == 'article' %}
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        {{ blog.title | link_to: blog.url }}
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        <span aria-current="page" class="is-current">{{ article.title | split: '|' | first }}</span>

      {% elsif template.name == 'page' %}
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        <span aria-current="page" class="is-current">{{ page.title }}</span>

      {% elsif template.name == 'search' %}
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        <span aria-current="page" class="is-current">{{ page_title | replace: '*', '' }}</span>

      {% else %}
        <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
        <span aria-current="page" class="is-current">{{ page_title }}</span>
      {% endif %}
    </nav>
  {% endunless %}
{% endif %}
