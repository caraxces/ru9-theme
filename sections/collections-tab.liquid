{% liquid
  if section.settings.section_width != 'page-width'
    if section.settings.section_width == 'full-width'
      assign page_width = '100%'
    endif
    if section.settings.section_width == 'customize_width'
      assign page_width = section.settings.customize_width | plus: 80 | append: 'px'
    endif
  endif
%}

<div
  class="collections-tab"
  id="CollectionTabSection-{{ section.id }}"
  data-section-id="{{ section.id }}"
  data-section-type="collection-grid"
  data-context="collections-tab"
>
  <div
    class="page-width"
    style="{% if section.settings.section_width != 'page-width' %}--page-width: {{ page_width }}{% endif %}"
  >
    <div class="collections-tab__content">
      <theme-tab>
        <div class="tab__item tab__panel">
          <ul class="tab__list inline-list gap-x-sm">
            {%- for block in section.blocks -%}
              <li class="tab__list-item{% if forloop.index == 1 %} is-active{% endif %}">
                <span class="btn tab__item-panel" id="Tab-{{ block.id }}">
                  {{ block.settings.tab_name }}
                </span>
              </li>
            {%- endfor -%}
          </ul>
        </div>
        <div class="tab__item tab__content relative">
          {%- for block in section.blocks -%}
            <div
              class="tab__content-item grid{% if forloop.index == 1 %} is-active{% endif %}"
              id="Tab-content-{{ block.id }}"
              data-tab-id="Tab-{{ block.id }}"
            >
              {% for product in block.settings.collection.products %}
                {%- render 'product-grid-item',
                  product: product,
                  per_row: 4,
                  type: 'horizontal',
                  quick_shop_enable: settings.quick_shop_enable,
                  image_style: section.settings.product_grid_image_size
                -%}
              {% endfor %}
            </div>
          {%- endfor -%}
        </div>
      </theme-tab>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Collections tab",
  "class": "index-section",
  "disabled_on": {
    "groups": ["footer", "header", "custom.popups"]
  },
  "settings": [
    {
      "type": "select",
      "id": "section_width",
      "options": [
        {
          "value": "full-width",
          "label": "t:sections.all.section_width.options__1"
        },
        {
          "value": "page-width",
          "label": "t:sections.all.section_width.options__2"
        },
        {
          "value": "customize_width",
          "label": "t:sections.all.section_width.options__3"
        }
      ],
      "default": "page-width",
      "label": "t:sections.all.section_width.label"
    },
    {
      "type": "range",
      "id": "customize_width",
      "min": 1005,
      "max": 1800,
      "step": 15,
      "default": 1800,
      "unit": "px",
      "label": "t:sections.all.customize_width.label"
    },
    {
      "type": "select",
      "id": "product_grid_image_size",
      "label": "t:settings_schema.product_tiles.settings.product_grid_image_size.label",
      "default": "natural",
      "options": [
        {
          "value": "natural",
          "label": "t:settings_schema.product_tiles.settings.product_grid_image_size.options.natural.label"
        },
        {
          "value": "circle",
          "label": "t:settings_schema.product_tiles.settings.product_grid_image_size.options.square.label"
        }
      ]
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "t:sections.all.collection.label",
      "settings": [
        {
          "type": "text",
          "id": "tab_name",
          "default": "Tab name",
          "label": "t:sections.all.tab_name.label"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collections tab",
      "blocks": [
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}
