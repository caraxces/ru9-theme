{% comment %}
  Section: Certifications
{% endcomment %}

<style>
  .certifications-section-{{ section.id }} {
    width: 100%;
    padding: 4.3rem 0 4.3rem 0;
    margin: 0 auto;
    font-family: "Be Vietnam Pro", sans-serif;
  }

  .certifications-section-{{ section.id }} .certifications__container {
    max-width: 1360px;
    margin: 0 auto;
    padding: 0 4.3rem;
  }

  /* --- Tablet Layout (1000px - 1359px) --- */
  @media (min-width: 1000px) and (max-width: 1359px) {
    .certifications-section-{{ section.id }} .certifications__container {
      display: grid;
      grid-template-columns: 0.8fr 1.2fr;
      column-gap: 34px;
      grid-template-areas:
        "title certifications"
        "description certifications"
        "cta certifications";
      align-items: start;
      margin: 0 auto;
      padding: 0 4.3rem;
    }

    .certifications-section-{{ section.id }} .cs-title { 
      grid-area: title; 
      font-size: 22px;
      line-height: 1.3;
      margin-bottom: 14px;
    }
    .certifications-section-{{ section.id }} .cs-description-wrapper { 
      grid-area: description; 
    }
    .certifications-section-{{ section.id }} .cs-description {
      font-size: 12px;
      line-height: 1.5;
      margin: 0 9px 17px 0;
    }
    .certifications-section-{{ section.id }} .cs-cta-wrapper { 
      grid-area: cta; 
      margin-top: 0;
    }
    .certifications-section-{{ section.id }} .certifications__slider-container { grid-area: certifications; }
    
    .certifications-section-{{ section.id }} .cs-cert-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 26px;
    }
  }

  /* --- Desktop Layout (2 columns) - 1360px+ --- */
  @media (min-width: 1360px) {
    .certifications-section-{{ section.id }} .certifications__container {
      display: grid;
      grid-template-columns: 0.8fr 1.2fr;
      column-gap: 68px;
      grid-template-areas:
        "title certifications"
        "description certifications"
        "cta certifications";
      align-items: start;
      margin: 0 auto;
      padding: 0 4.3rem;
    }

    .certifications-section-{{ section.id }} .cs-title { grid-area: title; }
    .certifications-section-{{ section.id }} .cs-description-wrapper { grid-area: description; }
    .certifications-section-{{ section.id }} .cs-cta-wrapper { 
      grid-area: cta; 
      margin-top: -60px;
    }
    .certifications-section-{{ section.id }} .certifications__slider-container { grid-area: certifications; }
    
    .certifications-section-{{ section.id }} .cs-cert-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 34px;
    }
  }

  .certifications-section-{{ section.id }} .cs-title {
    color: #1C2C58;
    font-family: 'Be Vietnam Pro', sans-serif;
    font-size: 33px;
    font-weight: 700;
    line-height: 1.4;
    margin: 0 0 17px 0;
    text-transform: none;
  }
  .certifications-section-{{ section.id }} .cs-description {
    color: #3C3C3C;
    font-size: 17px;
    font-weight: 400;
    text-align: justify;
    line-height: 1.6;
    margin: 0 9px 26px 0;
  }
  .certifications-section-{{ section.id }} .cs-cta {
    display: inline-flex;
    padding: 10px 30px;
    justify-content: center;
    align-items: center;
    border-radius: 85px;
    background: #234085;
    color: #fff;
    font-size: 17px;
    font-weight: 700;
    text-decoration: none;
    transition: background-color 0.3s ease;
    border: 1px solid transparent;
  }
  .certifications-section-{{ section.id }} .cs-cta:hover {
    background: #fff;
    color: #234085;
    border-color: #234085;
  }

  .certifications-section-{{ section.id }} .cs-cert-item {
    text-align: center;
  }
  .certifications-section-{{ section.id }} .cs-cert-image-wrapper {
    width: 100%;
    height: auto;
    aspect-ratio: 1/1;
    background: #F5F9FF;
    border-radius: 10px;
    margin-bottom: 20px;
    padding: 17px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .certifications-section-{{ section.id }} .cs-cert-image-wrapper img {
    max-width: 100%;
    max-height: 100%;
    height: auto;
    object-fit: contain;
  }
  .certifications-section-{{ section.id }} .cs-cert-labels {
    display: block;
  }
  .certifications-section-{{ section.id }} .cs-cert-label {
    font-size: 17px;
    color: #000;
    margin: 0 0 7px 0;
    font-weight: 400;
  }
  .certifications-section-{{ section.id }} .cs-cert-name {
    font-size: 17px;
    font-weight: 700;
    color: #1C2C58;
  }

  .certifications-section-{{ section.id }} .flickity-buttons,
  .certifications-section-{{ section.id }} .flickity-page-dots {
    display: none;
  }
  
  .certifications-section-{{ section.id }} .flickity-button {
    display: none;
  }
  
  /* --- Mobile Layout (Slider) --- */
  @media (max-width: 999px) {
    .certifications-section-{{ section.id }} {
      padding: 34px 0;
    }
    .certifications-section-{{ section.id }} .certifications__container {
      /* Padding handled by .page-width class - uses rem from homepage-fixed-layout.css */
      max-width: 100%;
      padding: 0 15px;
    }
    .certifications-section-{{ section.id }} .cs-title {
      font-size: 20px;
      font-weight: 600;
      line-height: 33.6px;
      letter-spacing: 0.6px;
      text-align: left;
      margin-bottom: 20px;
    }
    .certifications-section-{{ section.id }} .cs-description {
      margin-top: 20px;
      margin-bottom: 20px;
    }
    .certifications-section-{{ section.id }} .cs-cta-wrapper {
      text-align: left;
    }

    .certifications-section-{{ section.id }} .cs-cta {
      width: 100%;
      height: 34px;
      flex-shrink: 0;
    }

    .certifications-section-{{ section.id }} .certifications__slider-container {
      position: relative;
      background: #F5F9FF;
      border-radius: 10px;
      padding: 20px 20px 0px;
    }
    .certifications-section-{{ section.id }} .cs-cert-grid.flickity-enabled {
      display: block;
    }
    .certifications-section-{{ section.id }} .cs-cert-item {
      width: 100%;
    }
    .certifications-section-{{ section.id }} .cs-cert-image-wrapper {
      background: transparent;
    }
    .certifications-section-{{ section.id }} .cs-cert-labels {
      display: none;
    }

    .certifications-section-{{ section.id }} .flickity-page-dots {
      display: block;
      position: absolute;
      bottom: 17px;
      left: 20px;
      width: auto;
    }
    .certifications-section-{{ section.id }} .flickity-page-dots .dot {
      background: #E0E0E0;
    }
    .certifications-section-{{ section.id }} .flickity-page-dots .dot.is-selected {
      background: #1C2C58;
    }

    .certifications-section-{{ section.id }} .flickity-button {
      display: block;
      position: absolute;
      bottom: 9px;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: #fff;
      border: 1px solid #eee;
      color: #1C2C58;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .certifications-section-{{ section.id }} .flickity-button.previous {
      right: 61px;
    }
    .certifications-section-{{ section.id }} .flickity-button.next {
      right: 20px;
      background: #1C2C58;
      color: #fff;
    }
  }
</style>

<section class="certifications-section-{{ section.id }}">
  <div class="certifications__container page-width">
    {% if section.settings.title != blank %}
      <h2 class="cs-title">{{ section.settings.title | newline_to_br }}</h2>
    {% endif %}

    <div class="certifications__slider-container">
      <div class="cs-cert-grid" id="certifications-slider-{{ section.id }}">
        {% for block in section.blocks %}
          <div class="cs-cert-item">
            <div class="cs-cert-image-wrapper">
              {% if block.settings.image != blank %}
                <img
                  src="{{ block.settings.image | image_url: width: 400 }}"
                  alt="{{ block.settings.name | escape }}"
                  loading="lazy">
              {% else %}
                {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
              {% endif %}
            </div>
            <div class="cs-cert-labels">
              {% if block.settings.label != blank %}
                <p class="cs-cert-label">{{ block.settings.label }}</p>
              {% endif %}
              {% if block.settings.name != blank %}
                <h3 class="cs-cert-name">{{ block.settings.name }}</h3>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
       <button class="flickity-button next" aria-label="Previous"><svg class="flickity-button-icon" viewBox="0 0 100 100"><path d="M 10,50 L 60,100 L 70,90 L 30,50 L 70,10 L 60,0 Z" class="arrow" transform="translate(100, 100) rotate(180) "></path></svg></button>
       <button class="flickity-button previous" aria-label="Next"><svg class="flickity-button-icon" viewBox="0 0 100 100"><path d="M 10,50 L 60,100 L 70,90 L 30,50 L 70,10 L 60,0 Z" class="arrow"></path></svg></button>
    </div>
    
    <div class="cs-description-wrapper">
      {% if section.settings.description != blank %}
        <div class="cs-description rte">{{ section.settings.description }}</div>
      {% endif %}
    </div>

    <div class="cs-cta-wrapper">
      {% if section.settings.button_text != blank %}
        <a href="{{ section.settings.button_link }}" class="cs-cta">
          {{ section.settings.button_text }}
        </a>
      {% endif %}
    </div>
  </div>
</section>

{% schema %}
  {
    "name": "Certifications",
    "tag": "section",
    "class": "section-certifications",
    "settings": [
      {
        "type": "textarea",
        "id": "title",
        "label": "Title",
        "default": "Cam kết an toàn từ lần chạm đầu tiên"
      },
      {
        "type": "richtext",
        "id": "description",
        "label": "Description",
        "default": "<p>Tại Ru9, mỗi sản phẩm không chỉ mang đến sự thoải mái mà còn đảm bảo an toàn tuyệt đối cho sức khỏe người dùng ngay từ những lần tiếp xúc đầu tiên. Đó là lý do vì sao nệm và các chất liệu của Ru9 đều đạt được hai chứng nhận uy tín hàng đầu thế giới.</p>"
      },
      {
        "type": "text",
        "id": "button_text",
        "label": "Button Text",
        "default": "Xem chi tiết"
      },
      {
        "type": "url",
        "id": "button_link",
        "label": "Button Link"
      }
    ],
    "blocks": [
      {
        "type": "certification",
        "name": "Certification",
        "limit": 2,
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "label",
            "label": "Label",
            "default": "Chứng nhận"
          },
          {
            "type": "text",
            "id": "name",
            "label": "Certification Name",
            "default": "CertiPUR-US®"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Certifications",
        "blocks": [
          { "type": "certification" },
          { "type": "certification" }
        ]
      }
    ]
  }
{% endschema %}

<script>
document.addEventListener('DOMContentLoaded', () => {
  const sectionElement = document.querySelector('.certifications-section-{{ section.id }}');
  if (!sectionElement) return;

  const sliderElement = sectionElement.querySelector('#certifications-slider-{{ section.id }}');
  
  if (sliderElement && window.innerWidth <= 999) {
    const flkty = new Flickity(sliderElement, {
      cellSelector: '.cs-cert-item',
      contain: true,
      prevNextButtons: false,
      pageDots: true,
      wrapAround: true
    });

    const sliderContainer = sectionElement.querySelector('.certifications__slider-container');
    const prevButton = sliderContainer.querySelector('.flickity-button.previous');
    const nextButton = sliderContainer.querySelector('.flickity-button.next');
    
    if(prevButton) {
      prevButton.addEventListener('click', () => flkty.previous());
    }
    if(nextButton) {
      nextButton.addEventListener('click', () => flkty.next());
    }
  }
});
</script>
