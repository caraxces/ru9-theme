{%- assign disable_sticky_header = false -%}
{% liquid
  if section.settings.section_width != 'page-width'
    if section.settings.section_width == 'full-width'
      assign page_width = '100%'
    endif
    if section.settings.section_width == 'customize_width'
      assign page_width = section.settings.customize_width | plus: 80 | append: 'px'
    endif
  endif

  assign align = section.settings.align_text | prepend: 'text-'
%}
{%- if section.settings.enable -%}
  {%- if section.settings.collection_image_enable and collection.image -%}
    <div
      id="CollectionHeaderSection"
      data-section-id="{{ section.id }}"
      data-section-type="collection-header"
    >
      <div class="collection-hero">
        <div class="collection-hero__image-wrap">
          <img class="large-up-show" src="{{ collection.metafields.custom.banner_desktop | img_url: '2200x' }}" alt="{{ collection.title }}" class="collection-hero__image">
          <img class="large-up-hide" src="{{ collection.metafields.custom.banner_mobile | img_url: '768x' }}" alt="{{ collection.title }}" class="collection-hero__image">
        </div>

        <div class="collection-hero__content">
          <div
            class="page-width"
            style="{% if section.settings.section_width != 'page-width' %}--page-width: {{ page_width }}{% endif %}"
          >
            <header class="section-header section-header--hero {{ align }}">
              {%- if section.settings.show_breadcrumb -%}
                {%- if section.settings.custom_breadcrumb_text != blank -%}
                  <nav class="breadcrumb {{ align }}" role="navigation" aria-label="breadcrumbs">
                    <a href="{{ routes.root_url }}" title="{{ 'general.breadcrumbs.home_link_title' | t }}">
                      {{- 'general.breadcrumbs.home' | t -}}
                    </a>
                    <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
                    <span aria-current="page" class="is-current">{{ section.settings.custom_breadcrumb_text }}</span>
                  </nav>
                {%- else -%}
                  {%- render 'breadcrumbs', classes: align -%}
                {%- endif -%}
              {%- endif -%}
              {%- if section.settings.show_header -%}
                <h1 class="section-header__title text-3xl f-smb">
                  {%- if section.settings.custom_header_text != blank -%}
                    {{ section.settings.custom_header_text }}
                  {%- else -%}
                    {{ collection.title }}
                  {%- endif -%}
                </h1>
              {%- endif -%}
              {%- if section.settings.show_collection_description -%}
                <div class="rte section-header__desc" style="--mw: {{ section.settings.max_width_desc }}px;">
                  {{ collection.description }}
                </div>
              {%- endif -%}
            </header>
          </div>
        </div>
      </div>
    </div>
  {%- else -%}
    {%- assign disable_sticky_header = true -%}
    <div class="page-width page-content page-content--top">
      <header class="section-header section-header--flush {{ align }}">
        {%- if section.settings.show_breadcrumb -%}
          {%- if section.settings.custom_breadcrumb_text != blank -%}
            <nav class="breadcrumb {{ align }}" role="navigation" aria-label="breadcrumbs">
              <a href="{{ routes.root_url }}" title="{{ 'general.breadcrumbs.home_link_title' | t }}">
                {{- 'general.breadcrumbs.home' | t -}}
              </a>
              <span class="breadcrumb__divider" aria-hidden="true">{% render 'icon-caret' %}</span>
              <span aria-current="page" class="is-current">{{ section.settings.custom_breadcrumb_text }}</span>
            </nav>
          {%- else -%}
            {%- render 'breadcrumbs', classes: align -%}
          {%- endif -%}
        {%- endif -%}
        {%- if section.settings.show_header -%}
          <h1 class="section-header__title text-3xl f-smb">
            {%- if section.settings.custom_header_text != blank -%}
              {{ section.settings.custom_header_text }}
            {%- else -%}
              {{ collection.title }}
            {%- endif -%}
          </h1>
        {%- endif -%}
      </header>
    </div>
  {%- endif -%}
{% else %}
  {%- assign disable_sticky_header = true -%}
{%- endif -%}

{%- if disable_sticky_header -%}
  {% comment %}
    Div to trigger theme.CollectionHeader JS
  {% endcomment %}
  <div
    id="CollectionHeaderSection"
    data-section-id="{{ section.id }}"
    data-section-type="collection-header"
  ></div>
{%- endif -%}

<style>
  /* Remove custom canvas overrides - let theme handle canvas layout */
  .section-header{
    margin-top: 30px;
  }
  .collection-hero__image {
    width: 100%;
    height: 350px;
    object-fit: cover;
  }

  .large-up-show {
    display: block;
  }

  .large-up-hide {
    display: none;
  }

  .section-header__title {
    font-family: "Be Vietnam Pro", sans-serif !important;
  }

  .section-header__desc {
    font-family: "Be Vietnam Pro", sans-serif !important;
  }

  @media (max-width: 1023px) {
    .large-up-show {
      display: none;
    }
    .large-up-hide {
      display: block;
    }
  }
</style>

{% schema %}
{
  "name": "t:sections.collection-header.name",
  "settings": [
    {
      "type": "select",
      "id": "section_width",
      "options": [
        {
          "value": "full-width",
          "label": "t:sections.all.section_width.options__1"
        },
        {
          "value": "page-width",
          "label": "t:sections.all.section_width.options__2"
        },
        {
          "value": "customize_width",
          "label": "t:sections.all.section_width.options__3"
        }
      ],
      "default": "page-width",
      "label": "t:sections.all.section_width.label"
    },
    {
      "type": "range",
      "id": "customize_width",
      "min": 1000,
      "max": 1800,
      "step": 10,
      "default": 1800,
      "unit": "px",
      "label": "t:sections.all.customize_width.label"
    },
    {
      "type": "range",
      "id": "max_width_desc",
      "min": 500,
      "max": 2000,
      "step": 20,
      "default": 620,
      "unit": "px",
      "label": "Custom width content"
    },
    {
      "type": "text_alignment",
      "id": "align_text",
      "label": "t:sections.all.alignment.label__1",
      "default": "left"
    },
    {
      "type": "checkbox",
      "id": "enable",
      "label": "t:sections.collection-header.settings.enable.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "collection_image_enable",
      "label": "t:sections.collection-header.settings.collection_image_enable.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_collection_description",
      "default": true,
      "label": "t:sections.collection-header.settings.show_collection_description.label",
      "info": "t:sections.collection-header.settings.show_collection_description.info"
    },
    {
      "type": "checkbox",
      "id": "show_header",
      "default": true,
      "label": "Show collection header title",
      "info": "Enable or disable the collection title (h1) display"
    },
    {
      "type": "text",
      "id": "custom_header_text",
      "label": "Custom header text",
      "info": "Leave empty to use collection title. Custom text will override collection title."
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumb",
      "default": true,
      "label": "Show breadcrumb",
      "info": "Enable or disable breadcrumb navigation"
    },
    {
      "type": "text",
      "id": "custom_breadcrumb_text",
      "label": "Custom breadcrumb text",
      "info": "Leave empty to use default breadcrumb. Custom text will override default breadcrumb for collection name."
    }
  ],
  "disabled_on": {
    "groups": ["footer", "header", "custom.popups"]
  }
}
{% endschema %}
